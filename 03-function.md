# 関数呼び出し

さぁ、お絵かきの時間です。算数の時間かもしれません。いずれにしても、未知なものの正体を解き明かそうとするとき、想像力は大切です。

抽象的な言葉で遊ぶのはこれくらいにして、ゲームのルールを説明しましょう。

このゲームではまず、簡単な Rust のコードが与えられます。そして、あなたはそれの動きを一種の図で可視化してください答えてください。

## 例題1

```rust
fn main() {
  let x = f(1);
}

fn f(n: i32) -> i32 {
  n + 2
}
```

見ての通り、`f(n)` は引数に `2` を足した数を返す関数です。

(`i32` が気になりますか?　ただの符号付き32bit整数の型名です)

そして、`main` 関数はそれに `1` を渡して、戻り値を `x` に代入しています。

つまり、`1` に `2` を足して `3` を `x` に代入しているということになります。

おっと、求められている答えは `3` ではなく、**図** でした。

この場合の解答は、次のようになります。

![](03-function/fn-diag-01.png)

## 例題2

ルールを理解するために、もう少し練習してみましょう。

```rust
fn main() {
  let x = f(1);
  let y = f(x);
}

fn f(n: i32) -> i32 {
  n + 2
}
```

この問題の解答は次のようになります。

![](03-function/fn-diag-02.png)

察しがついてきましたか?

解答の図の書き方は以下のとおりです。

1. `main` 関数の実行から始まる
2. 関数の実行は、関数名と、括弧で囲まれた引数の値と、下線によって表現される
3. 関数の呼び出し順は先のものが左、後のものが右になる
4. 関数呼び出しは斜め右下向きの矢印で表現される
5. 関数の戻りは斜め右上向きの矢印で表現される
6. 関数の戻り値は、関数の戻りの矢印の右に書く
7. 関数の下線は、呼び出した関数が戻ってくるまで伸びていなければならない

## 問題

ゲームのルールを理解したところで、次の問題を解いてみてください。

```rust
fn main() {
  let x = f(1);
  let y = g(x);
}

fn f(n: i32) -> i32 {
  n + 2
}

fn g(n: i32) -> i32 {
  let x = a(n);
  let y = b(n);
  x + y
}

fn a(n: i32) -> i32 {
  n * 2
}

fn b(n: i32) -> i32 {
  let x = f(n);
  a(x)
}
```

正解の図はリンク先に置いておきます。解けたら答え合わせをしてみてくださいね。

[正解の図](./03-function/fn-diag-ans.png)

## まとめ

この図からは大切なことがいくつか読み取れるのですが、それらについてまとめるのはまた別の機会としましょう。
